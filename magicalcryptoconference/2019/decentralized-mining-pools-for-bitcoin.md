---
title: Decentralized Mining Pools for Bitcoin
transcript_by: kouloumos
speaker: Bob McElrath
categories: ['conference', 'mining']
---

Name: Bob McElrath

Topic: Decentralized Mining Pools for Bitcoin

Date: May 12th 2019

Video: https://www.youtube.com/watch?v=91WKy7RYHD4



I'm talking about decentralized mining pools for Bitcoin. This talk is really kind of a call to action. I think a lot of people believe there is a very serious threat in the decentralization of Bitcoin and most of the cryptocurrencies that matter revolving around mining pools. I'm going to show you the why, I'm gonna show you some of the how, and I think we need to build this and hopefully people will be interested enough to join me in this. 

# Why build a Decentralized Mining Pool

So why build a decentralized mining pool? Large pools are probably the biggest threat to decentralization. There are very few parties you have to contact and co-opt. If governments wanted to shut down Bitcoin, they only have to contact three, maybe four of the largest pools and they could completely censor transactions, they could do all kinds of mayhem. 

Pools can censor transactions, if the government went to them and said please censor these addresses or these UTXOs they could. A big part of the solution to this is Matt Corello's work who will be speaking after me on his work on BetterHash. 

Pools can also refuse payout or cheat. They hold large wallets and they're responsible for paying you for your shares. They do accounting for those shares, and they could in principle, do that accounting improperly. 

And your recourse in the event of any of the above is poor, unless you live in the same jurisdiction as your pool and you have a legal contract with them. I don't think very many people have a legal contract besides the terms or conditions on some website about the pool they're using. 

So any proposed decentralized pool has to be markedly better than the centralized tools we're using now. How can we do that? So today, the new idea I am going to throw out there in this talk is the idea that we create a new coin for shares for mining shares. I'll justify why that makes sense. This can become the basis for derivative instruments, which allows miners to hedge their risk with respect to purchasing mining hardware and running mining hardware. 

Second element is using a directed acyclic graph. This is some work I've been doing for a couple of years. There are two other talks out there that I've given on directly acyclic graph based blockchains. If you google the phrase [Braiding the Blockchain](https://btctranscripts.com/scalingbitcoin/hong-kong-2015/braiding-the-blockchain/), you'll find two talks by me that go into more detail. I don't have time here today going to great detail but talk to me afterwards, I can give you lots of lots of details.

Another element is the use of relay networks. The orphan rate on Bitcoin is way down in the last couple of years compared to previously and a large part of that, I believe, is due to the relay networks. 

Payment channel based payouts. We've had an explosion in the Lightning Network. We've had an explosion in noncustodial trading, which is also using payment channels. We could be using payment channels to pay hashers instead of making large coinbases as some pools do. 

Finally, BetterHash is out there. It is very good for low latency communication with your mining hardware, your hashing equipments as well as running your own node and constructing your own blocks, thereby avoiding the censorship problem of pools. 

# Block time matters for pool size

First of all, let's take a look at the the state of mining pools. On the left we have Bitcoin and you can see who do I have to co-opt if I want to censor transactions on Bitcoin. I've got two pools in China and with a couple of others, maybe that'll be enough. Any government agency who wants to contact only four companies, this is not really a big deal for them. 

If we look at Ethereum on the right hand side, there's something I want to call attention to here and that is that if you look at the top left of the graph right there, you may notice that there are a lot more smaller pools on Ethereum. Why is that? I think the large pools on the right here are mostly a social phenomenon, and you don't actually need those large pools from a profit or hedging perspective. 

If you take a look at Bitcoin and you ask, alright, I want to make sure my profits are within 1% of some target. I bought a bunch of equipment, I know what's gonna compute this many hashes, I'm gonna assume the hash rate is constant or something like that and assume the price of Bitcoin and I want to make sure I hit my target within 1% that means you have to have a pool is at least 19% of the Bitcoin network. And this is simply based on statistics based upon how many blocks per year get mined. If you do the same calculation for Ethereum, you need to have a pool that is 0.47% of the network. The reason for this is simply that Ethereum has faster blocks, there are more blocks in a year and any given pool will have more blocks and therefore less error on the amount of blocks they received and therefore error on their profits. 

So one of the things that we have to do if we want to create a decentralized mining pool is decrease the block time - increase the block rate. What mining pools do in the first place, and why would people use them? The reason pools exist is because they decrease your variance. If I'm a miner and let's say I have enough mining equipment to mine one block per month, which is which is an investment in mining hardware around a million dollars, this is a small mining operation these days. That one block per month, the error on poisson statistics is the square root, so this means that on 10 blocks per year, instead of 12, the error is about 3. So I might win 7 blocks in a year, I might win 13. If I'm 7 that's way down from my expected target and if I have to pay power bills, I may not be able to pay them because I just simply didn't get enough. And this is simply luck. There's nothing I can do to fix that. And what people do is they join these pools. The pool itself wins more blocks, and thereby decreases the variance in your payout.

5:48
This 1% annual profit variation corresponds to 3.5% monthly profit variation. And so if you're a miner, you have to be able to you're using one of these 19% pools, you have to be able to handle a monthly variation downwards by 3.5% in any given month. That means there's a 60% chance one standard deviation, that your monthly profits are within 3.5 cents percent of your net you've targeted so within one year, if you're a miner who can approximately one one block per month, I will have roughly two months where I'm below in my in my earnings by 3.5%. That's using a 19% pool. So this is why people use pools in the first place is to reduce this this variation the only way really to affect this is to increase the sampling rate and thereby decrease the block time. So historically, there is a decent blood mining pool out there. It's called Pupo. It was a decentralized mining pool. It is now mostly defunct. It is a blockchain. It has emerged mined blockchain any block on the p2p block pool blockchain can be a Bitcoin block that has a lower target difficulty by about a factor of 20 compared to Bitcoin, which means there's 20 times more blocks or a block time about 30 seconds. The consequence of decreasing the block time in a blockchain is you get more orphans. There's a higher probability that two people on opposite sides of the earth accidentally mine a block at approximately the same time and one of them wins the race and is able to get the block to the other miners more quickly. And people want on top of it and extend the longest chain because of this drastically increased orphan rate, the your payout up to pool, they actually kept track of the orphans and your payout was relative to your your relative what they called stale rate or dead on arrival. This is one of the problems with people it's a bit of a marketing problem to call your chairs dead on arrival. So you go on your status page and you see dead on arrival in your your payouts. A lot people look at that and say what the heck am I doing on this pool? Maybe I should go to one it doesn't tell me I'm dead. So this, what this means is that you can optimize your payout by optimizing your latency with respect to other nodes in the p2p network. And I've heard informally from people who were actually doing this that they could achieve 140% increase in profit by optimizing which peers they connected to on the pool network. So this is bad, right? This is not fair by any means. Right? This is worse than that centralized pools. So the way you get faster is you have to decrease the block time, right? And if I decrease it far enough, I get more orphans and I get blocks and I'm no longer able to move the state forward. The solution is the fastest you can get here is to move from a blockchain to a direct acyclic graph. a directed acyclic graph has the property that any given block can name more than one parent, right? This allows you to get down to the fact that you could possibly run this and based on some analysis I did a couple of years ago, back before the relay networks came online we can get down to a block time around six seconds with a structure with Relay networks, I believe I believe we can get down to a block time around half a second. So this is a factor of 1000 Faster than Bitcoin. Which means 1000 times smaller pools 1000 times faster block rate and a substantial decrease in your your variance for your payout. So the new idea I really want to talk about in this talk is using shares as a derivative instrument. So when you mined on a centralized pool, you have a share right in the share is just held in a database by the pool operator and they promise to pay you proportional to your shares and they do all the accounting for you and you hope that they do it correctly. The distributed mining pool, decentralized mining pool does all this accounting via consensus rules of the blockchain so everybody can verify that they're getting getting paid correctly. Now, there are two things that miners need in order to ensure their profits. As financial markets evolve, they start to develop more sophisticated financial instruments for for various things. And if you're a producer, this is really a producer consumer environment. This is very similar to if you're extracting oil, you're growing corn, and there are financial instruments created for those those commodities markets to allow you to hedge your uncertainties in your production. So the uncertainty in your production fundamentally in Bitcoin is the hash rate. I don't know what the hash rate is going to be tomorrow or next month or next year. And my profit is a function of that. So if I had a financial instrument, or I could buy a contract, they would pay me at the hash rate is larger than I expect or I would pay them if it's lower than I expected. I earned more than I expected. This would enable me to smooth out my profits and essentially ensure that I am profitable. This is the function of derivative markets. It's a function of futures and options markets for commodities. So the way we have to do this on a blockchain is we have to make the shared coin the fundamental commodity in in Bitcoin is the hash rate is not Bitcoin it's a hash rate. We convert that hash rate into bitcoin via the the emission schedule having a number of Bitcoins that are produced in the coin base.

So let's imagine that this was actually its own coin. So because there is a blockchain, some of the blocks in this direct acyclic graph based blockchain are Bitcoin blocks, and each of the coin bases of that blockchain allocate a number of Terra hash coins proportional to the difficulty. So I as a miner can collect these Terra hash coins, and then it's up to me to decide what to do with them. I want to exchange for Bitcoin because their hash coins are not worthwhile by themselves. They are simply an instrument. What we're really doing here is creating a derivative market right a derivative is dy dx. Are there two variables there? There's y and there's apps. So I have two instruments now to create a derivative. So the two instruments here are the hash rate coin and Bitcoin I'm creating D Bitcoin, the hash rate, right? And with that, I can create a futures instrument or an options instrument that would allow me to hedge my hedge my exposure to the hash rate. So the first element we need to hedge against is how many blocks do I win? Or am I cool with this is simply luck, right? And it's a function of the hash rate to other people that are out there. Second thing I need to hedge is the price of Bitcoin right? There already futures in Smith's out there for that CME has a number of markets now for futures on the the Fiat value of Bitcoin, but I still don't know how many bitcoins I'm going to get. So I need to hedge both. In order to have a proper mining operations. So just as an example, just just as a mental model 36 million Tera hashes approximately one that's nine months at 14 terabytes per second for this picture that the this merged mined blockchain consumes Tera hash coins and produces Bitcoins. So I can create a transaction which sends my Tera hash points and says Please exchange these for Bitcoin at the next available Coinbase opportunity that Coinbase will then destroy with our hash points and produce the Bitcoin Fundamentally, this is what we're doing anyway. Right? The miners are creating hashes that computing a certain number of shots at 60 calculations, and out of that comes Bitcoin. Now, all we're really doing is adding an accounting layer for the number of shots or D six D calculations performed, and we're just enforcing this rule that we're gonna swap those four for Declan. The interesting thing about having this as a coin is not as many ways to do this, I can create a market in which I create a contract that says I promised to deliver a certain number of cash coins and you promised to deliver me Bitcoin. This is a futures instrument. So why a Terra hash coin? In traditional futures markets that produce the good is delivered at the end of the futures contract. If I'm a corn grower, at the end of the day, a truck shows up somewhere with a bunch of corn on it, right? What is the produced good? If I'm talking about mining the produce good is a certain number of traffic

in such a way that those hashes that were calculated could have been Bitcoin blocks. Maybe some of them maybe work, but I need to prove that I have done that number of topics 60 calculations. That's nothing to do calculation in isolation is useless. I just plug in my asinine document into a pool. It's wasting energy, that those houses are not useless or are useless. So what I need is that the hash of the work computed could have been Bitcoin blocks but had too low of a target the focus, but the target difficulty in the share chain is proof that I did a certain number of calculations. So arbitraging, this hash rate variance requires ability to deliver those unlucky hashes to someone who is perhaps someone other than the pool operator. Right. I want to deliver those hashes to an arbitrator. There are professional arbitration firms who all they do is they look at production of oil or corn, lots of other things they market make futures markets and options markets, and they perform the service of absorbing risk for the producers of those goods. I've heard informally from a number of very large projects who do this kind of trading, but they are very interested in trading and absorbing this kind of risk modeling this kind of risk. If you're a miner and you have to model all this risk, in addition to actually running a profitable mining operation. That's a lot of burden on you. There are professional firms out there who do it and will sell you a contract, if they could. So a couple of examples forward contract. oral contract is a private agreement to buy the share coins for Bitcoin of fixed rate at a fixed time. So one month from now, I'm gonna give you my collective share Tera hash coins, and I know exactly how many I'm going to have, right because I have a s nine it competes 14 terabytes per second. Now plug it in for a month. This corresponds about 36 exa hashes. This is 14 terabytes a second finding the number of seconds in a month and today's price this is about point 013 Bitcoin. So let me create a contract to deliver you these extra hash coins with Terra hash coins, and you're gonna give me that Bitcoin a month from now. forward contracts must be settled. This is really private contracts and markets have developed around futures contracts which are standardized, Saturday's types of contracts which are rebalanced every day. Another option for arbitraging your risk is a call option, and this is the auction but not the obligation to buy these terrorists points for Bitcoin at a fixed price sometime in the future. So in other words, if I earn more money than I expected, I'm not required to settle this, right. This is called being out of the money. I'm not required to settle this contract. But if I'm, if I'm in the money, I can call this option and require the counterparty to deliver the Bitcoin to me. For some comparisons, there are weather Futures On The CME. If you were a producer of oil, and it's too warm in the winter, and nobody's using oil to heat their homes. People arbitrage their exposure to the weather via these kind of weather conference. Alright, with a two minute talk, we'll talk more people find me afterwards. Conclusions. I think we need to reboot pool I think we need to rebuild decentralized mining pool this would solve the the centralization problem we have around pool say this might consist of a Terra hash coin. This would enable us to build decentralized or not even decentralized decentralized markets. That would enable us to arbitrage risk. We need better hash which will be map and say a few words about after this, which allows me to build our own blocks and is a stratum replacement, a new wire protocol that many great things directly said the graphs last grade, which lets us run the thing faster. And this this number 1000 45,000 times faster is about as fast as you can get if you want to go faster than that we have to go to some other completely different kinds of technology. Finally, with all the work has been going on payment channels, we could be doing these these payouts to your channel to one of the really unfortunate things about p2p Is it put everybody's pay up in the coin base. And so you have these giant coin bases with 1000s of people being paid. We're just competing in block size against the fees you might have earned. If we use payment channels for that we can remove all of that on chain data and instead have your coin base via channel opening through which all the other hashes so there's RC channel for this free pool. There's a number of other ideas discussed besides what I've been mentioning here. Please come to any builders
